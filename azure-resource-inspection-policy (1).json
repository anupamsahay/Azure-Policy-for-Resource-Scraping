{
  "Name": "Resource-Inspection-CostOptimization-Comprehensive-Role",
  "Id": "/providers/Microsoft.Authorization/roleDefinitions/{guid}",
  "IsCustom": true,
  "Description": "Comprehensive read-only role for resource inspection across all specified Azure services to identify cost savings opportunities and ensure consistency",
  "Actions": [
    "// Core Management and Cost Analysis",
    "Microsoft.Advisor/*/read",
    "Microsoft.Authorization/*/read",
    "Microsoft.Billing/*/read",
    "Microsoft.Consumption/*/read",
    "Microsoft.CostManagement/*/read",
    "Microsoft.Resources/subscriptions/read",
    "Microsoft.Resources/subscriptions/resourceGroups/read",
    "Microsoft.Resources/subscriptions/resources/read",
    "Microsoft.Resources/deployments/*/read",
    "Microsoft.Resources/tags/read",
    "Microsoft.Management/managementGroups/read",
    
    "// Virtual Machines and Compute",
    "Microsoft.Compute/*/read",
    "Microsoft.Compute/virtualMachines/read",
    "Microsoft.Compute/virtualMachines/instanceView/read",
    "Microsoft.Compute/virtualMachines/extensions/read",
    "Microsoft.Compute/virtualMachineScaleSets/*/read",
    "Microsoft.Compute/availabilitySets/read",
    "Microsoft.Compute/disks/read",
    "Microsoft.Compute/snapshots/read",
    "Microsoft.Compute/images/read",
    "Microsoft.Compute/galleries/*/read",
    "Microsoft.HybridCompute/*/read",
    
    "// Storage Services",
    "Microsoft.Storage/*/read",
    "Microsoft.Storage/storageAccounts/read",
    "Microsoft.Storage/storageAccounts/listKeys/action",
    "Microsoft.Storage/storageAccounts/listAccountSas/action",
    "Microsoft.Storage/storageAccounts/blobServices/*/read",
    "Microsoft.Storage/storageAccounts/fileServices/*/read",
    "Microsoft.Storage/storageAccounts/queueServices/*/read",
    "Microsoft.Storage/storageAccounts/tableServices/*/read",
    "Microsoft.ClassicStorage/*/read",
    
    "// Microsoft Fabric",
    "Microsoft.Fabric/*/read",
    "Microsoft.Fabric/capacities/read",
    "Microsoft.Fabric/workspaces/read",
    
    "// Virtual Network and Networking",
    "Microsoft.Network/*/read",
    "Microsoft.Network/virtualNetworks/read",
    "Microsoft.Network/virtualNetworks/subnets/read",
    "Microsoft.Network/networkInterfaces/read",
    "Microsoft.Network/networkSecurityGroups/read",
    "Microsoft.Network/publicIPAddresses/read",
    "Microsoft.Network/privateDnsZones/*/read",
    "Microsoft.Network/privateEndpoints/read",
    "Microsoft.Network/networkWatchers/*/read",
    
    "// Backup and Recovery Services",
    "Microsoft.RecoveryServices/*/read",
    "Microsoft.RecoveryServices/vaults/*/read",
    "Microsoft.RecoveryServices/vaults/backupFabrics/*/read",
    "Microsoft.RecoveryServices/vaults/backupPolicies/read",
    "Microsoft.RecoveryServices/vaults/backupJobs/read",
    "Microsoft.Backup/*/read",
    "Microsoft.DataProtection/*/read",
    
    "// Azure Data Factory v2",
    "Microsoft.DataFactory/*/read",
    "Microsoft.DataFactory/factories/*/read",
    "Microsoft.DataFactory/factories/pipelines/read",
    "Microsoft.DataFactory/factories/datasets/read",
    "Microsoft.DataFactory/factories/linkedservices/read",
    "Microsoft.DataFactory/factories/integrationruntimes/read",
    
    "// Azure NetApp Files",
    "Microsoft.NetApp/*/read",
    "Microsoft.NetApp/netAppAccounts/read",
    "Microsoft.NetApp/netAppAccounts/capacityPools/read",
    "Microsoft.NetApp/netAppAccounts/capacityPools/volumes/read",
    
    "// Bandwidth and ExpressRoute",
    "Microsoft.Network/expressRouteCircuits/*/read",
    "Microsoft.Network/expressRouteGateways/*/read",
    "Microsoft.Network/expressRoutePorts/*/read",
    "Microsoft.Network/expressRouteCrossConnections/*/read",
    "Microsoft.Network/virtualWans/*/read",
    "Microsoft.Network/vpnGateways/*/read",
    "Microsoft.Network/vpnSites/*/read",
    
    "// GitHub (Azure DevOps Integration)",
    "Microsoft.DevOps/*/read",
    "Microsoft.VisualStudio/*/read",
    "Microsoft.VSOnline/*/read",
    
    "// SQL Database and Managed Instance",
    "Microsoft.Sql/*/read",
    "Microsoft.Sql/servers/*/read",
    "Microsoft.Sql/servers/databases/*/read",
    "Microsoft.Sql/servers/elasticPools/*/read",
    "Microsoft.Sql/managedInstances/*/read",
    "Microsoft.Sql/managedInstances/databases/*/read",
    "Microsoft.SqlVirtualMachine/*/read",
    
    "// Azure Analysis Services",
    "Microsoft.AnalysisServices/*/read",
    "Microsoft.AnalysisServices/servers/*/read",
    
    "// Azure Synapse Analytics",
    "Microsoft.Synapse/*/read",
    "Microsoft.Synapse/workspaces/*/read",
    "Microsoft.Synapse/workspaces/sqlPools/*/read",
    "Microsoft.Synapse/workspaces/sparkPools/*/read",
    "Microsoft.Synapse/workspaces/integrationRuntimes/read",
    
    "// Log Analytics",
    "Microsoft.OperationalInsights/*/read",
    "Microsoft.OperationalInsights/workspaces/*/read",
    "Microsoft.OperationalInsights/workspaces/analytics/query/action",
    "Microsoft.OperationsManagement/*/read",
    
    "// Microsoft Security Copilot and Defender",
    "Microsoft.Security/*/read",
    "Microsoft.SecurityInsights/*/read",
    "Microsoft.Security/securityCopilot/*/read",
    "Microsoft.Security/pricings/read",
    "Microsoft.Security/assessments/read",
    "Microsoft.Security/secureScores/read",
    
    "// Cognitive Services",
    "Microsoft.CognitiveServices/*/read",
    "Microsoft.CognitiveServices/accounts/*/read",
    "Microsoft.Cognitive/*/read",
    
    "// Load Balancer",
    "Microsoft.Network/loadBalancers/*/read",
    "Microsoft.Network/loadBalancers/backendAddressPools/read",
    "Microsoft.Network/loadBalancers/frontendIPConfigurations/read",
    
    "// Azure Container Apps",
    "Microsoft.App/*/read",
    "Microsoft.App/containerApps/*/read",
    "Microsoft.App/managedEnvironments/*/read",
    
    "// Azure Cosmos DB",
    "Microsoft.DocumentDB/*/read",
    "Microsoft.DocumentDB/databaseAccounts/*/read",
    
    "// NAT Gateway",
    "Microsoft.Network/natGateways/*/read",
    
    "// API Management",
    "Microsoft.ApiManagement/*/read",
    "Microsoft.ApiManagement/service/*/read",
    
    "// Event Hubs",
    "Microsoft.EventHub/*/read",
    "Microsoft.EventHub/namespaces/*/read",
    "Microsoft.EventHub/clusters/*/read",
    
    "// Virtual Machine Licenses",
    "Microsoft.Compute/licenseTypes/read",
    "Microsoft.HybridCompute/licenses/read",
    "Microsoft.WindowsESU/*/read",
    
    "// Azure Firewall",
    "Microsoft.Network/azureFirewalls/*/read",
    "Microsoft.Network/firewallPolicies/*/read",
    
    "// Azure Cognitive Search",
    "Microsoft.Search/*/read",
    "Microsoft.Search/searchServices/*/read",
    
    "// VPN Gateway",
    "Microsoft.Network/vpnGateways/*/read",
    "Microsoft.Network/virtualNetworkGateways/*/read",
    "Microsoft.Network/localNetworkGateways/*/read",
    "Microsoft.Network/connections/*/read",
    
    "// Azure App Service",
    "Microsoft.Web/*/read",
    "Microsoft.Web/sites/*/read",
    "Microsoft.Web/serverFarms/*/read",
    "Microsoft.Web/hostingEnvironments/*/read",
    "Microsoft.Web/certificates/read",
    
    "// Application Gateway",
    "Microsoft.Network/applicationGateways/*/read",
    "Microsoft.Network/applicationGatewayWebApplicationFirewallPolicies/*/read",
    
    "// Logic Apps",
    "Microsoft.Logic/*/read",
    "Microsoft.Logic/workflows/*/read",
    "Microsoft.Logic/integrationAccounts/*/read",
    
    "// Azure Database for PostgreSQL",
    "Microsoft.DBforPostgreSQL/*/read",
    "Microsoft.DBforPostgreSQL/servers/*/read",
    "Microsoft.DBforPostgreSQL/flexibleServers/*/read",
    
    "// Azure DNS",
    "Microsoft.Network/dnsZones/*/read",
    "Microsoft.Network/privateDnsZones/*/read",
    "Microsoft.Network/dnsResolvers/*/read",
    
    "// Container Registry",
    "Microsoft.ContainerRegistry/*/read",
    "Microsoft.ContainerRegistry/registries/*/read",
    
    "// Azure Route Server",
    "Microsoft.Network/virtualHubs/*/read",
    "Microsoft.Network/routeServers/*/read",
    
    "// Event Grid",
    "Microsoft.EventGrid/*/read",
    "Microsoft.EventGrid/topics/*/read",
    "Microsoft.EventGrid/domains/*/read",
    "Microsoft.EventGrid/systemTopics/*/read",
    
    "// Intelligent Recommendations",
    "Microsoft.RecommendationsService/*/read",
    "Microsoft.Advisor/recommendations/read",
    
    "// Microsoft Entra Domain Services",
    "Microsoft.AAD/*/read",
    "Microsoft.AAD/domainServices/*/read",
    
    "// SaaS",
    "Microsoft.SaaS/*/read",
    "Microsoft.Marketplace/*/read",
    
    "// Azure Monitor",
    "Microsoft.Insights/*/read",
    "Microsoft.Monitor/*/read",
    "Microsoft.Insights/metrics/read",
    "Microsoft.Insights/metricDefinitions/read",
    "Microsoft.Insights/diagnosticSettings/read",
    "Microsoft.Insights/logDefinitions/read",
    "Microsoft.Insights/logs/read",
    "Microsoft.AlertsManagement/*/read",
    
    "// Azure Kubernetes Service (AKS)",
    "Microsoft.ContainerService/*/read",
    "Microsoft.ContainerService/managedClusters/*/read",
    "Microsoft.Kubernetes/*/read",
    
    "// Functions",
    "Microsoft.Web/sites/functions/read",
    "Microsoft.Web/sites/hostruntime/*/read",
    
    "// Redis Cache",
    "Microsoft.Cache/*/read",
    "Microsoft.Cache/redis/*/read",
    "Microsoft.Cache/redisEnterprise/*/read",
    
    "// Key Vault",
    "Microsoft.KeyVault/*/read",
    "Microsoft.KeyVault/vaults/*/read",
    "Microsoft.KeyVault/managedHSMs/*/read",
    
    "// Service Bus",
    "Microsoft.ServiceBus/*/read",
    "Microsoft.ServiceBus/namespaces/*/read",
    
    "// Container Instances",
    "Microsoft.ContainerInstance/*/read",
    "Microsoft.ContainerInstance/containerGroups/*/read",
    
    "// Communication Services (Phone Numbers, Voice)",
    "Microsoft.Communication/*/read",
    "Microsoft.Communication/communicationServices/*/read",
    
    "// Automation",
    "Microsoft.Automation/*/read",
    "Microsoft.Automation/automationAccounts/*/read",
    
    "// Azure Databricks",
    "Microsoft.Databricks/*/read",
    "Microsoft.Databricks/workspaces/*/read",
    
    "// Azure Grafana Service",
    "Microsoft.Dashboard/*/read",
    "Microsoft.Dashboard/grafana/*/read",
    
    "// Insight and Analytics",
    "Microsoft.DataLakeAnalytics/*/read",
    "Microsoft.DataLakeStore/*/read",
    "Microsoft.StreamAnalytics/*/read",
    "Microsoft.TimeSeriesInsights/*/read",
    
    "// Azure Arc",
    "Microsoft.HybridCompute/*/read",
    "Microsoft.AzureArcData/*/read",
    "Microsoft.Kubernetes/connectedClusters/*/read",
    "Microsoft.ExtendedLocation/*/read",
    "Microsoft.ResourceConnector/*/read",
    
    "// Azure Arc Enabled Databases",
    "Microsoft.AzureArcData/sqlManagedInstances/*/read",
    "Microsoft.AzureArcData/postgresInstances/*/read",
    "Microsoft.AzureArcData/dataControllers/*/read",
    
    "// Azure Stack HCI (Azure Local)",
    "Microsoft.AzureStackHCI/*/read",
    "Microsoft.AzureStackHCI/clusters/*/read",
    "Microsoft.AzureStackHCI/virtualMachines/*/read",
    
    "// Additional Support Services",
    "Microsoft.Support/*/read",
    "Microsoft.Portal/*/read",
    "Microsoft.Capacity/*/read",
    "Microsoft.Quota/*/read",
    "Microsoft.Commerce/*/read",
    "Microsoft.Subscription/*/read",
    
    "// Generic read for any missed resources",
    "*/read"
  ],
  "NotActions": [
    "Microsoft.Authorization/*/write",
    "Microsoft.Authorization/*/delete",
    "Microsoft.Authorization/elevateAccess/action",
    "Microsoft.Blueprint/*/write",
    "Microsoft.Security/*/write"
  ],
  "DataActions": [
    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/read",
    "Microsoft.Storage/storageAccounts/fileServices/fileshares/files/read",
    "Microsoft.KeyVault/vaults/secrets/getSecret/action",
    "Microsoft.KeyVault/vaults/keys/read"
  ],
  "NotDataActions": [
    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/write",
    "Microsoft.Storage/storageAccounts/blobServices/containers/blobs/delete",
    "Microsoft.KeyVault/vaults/secrets/setSecret/action"
  ],
  "AssignableScopes": [
    "/subscriptions/{subscription-id}",
    "/subscriptions/{subscription-id}/resourceGroups/{resource-group-name}",
    "/providers/Microsoft.Management/managementGroups/{management-group-id}"
  ],
  "Conditions": [],
  "ConditionVersion": "2.0"
}